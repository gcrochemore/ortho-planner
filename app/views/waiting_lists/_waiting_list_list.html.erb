<% if waiting_lists.count > 0 %>
  <div class="row">
    <div class="col-xs-1 text-center">
      <%= sort_link(@q, :start_date, default_order: :asc) %>
    </div>
    <div class="col-xs-9 text-center">
      <h4><%= sort_link(@q, :patient, default_order: :asc) %></h4>
    </div>
  </div>
  <% waiting_lists.each do |waiting_list| %>
    <div class="row">
      <div class="col-xs-12 col-md-1">
        <br><br>
        <strong><%= waiting_list.start_date.andand.strftime(DATE_FORMAT) %></strong><br>(<%= waiting_list.age %> mois)
      </div>
      <div class="col-xs-12 col-md-9">
        <%= render 'patients/patient_view', patient: waiting_list.patient %> 
      </div>
      <div class="col-xs-12 col-md-2">
        <% if (can? :take_care, WaitingList) && !waiting_list.end_date.present? && !waiting_list.waiting_for_patient_return %>
          <%= link_to take_care_waiting_list_path(waiting_list), class: "btn btn-info btn-sm btn-block" do %>
            <i class="glyphicon glyphicon-saved"></i> Prendre en charge
          <% end %>
        <% end %>
        <% if can? :add_interaction, WaitingList %>
          <%= link_to add_interaction_waiting_list_path(waiting_list), class: "btn btn-info btn-sm btn-block" do %>
            <i class="glyphicon glyphicon-earphone"></i> Ajouter un appel
          <% end %>
        <% end %>
        <% if (can? :patient_never_return, WaitingList) && waiting_list.waiting_for_patient_return %>
          <%= link_to patient_never_return_waiting_list_path(waiting_list), class: "btn btn-info btn-sm btn-block" do %>
            <i class="glyphicon glyphicon-remove"></i> Le patient n'a jamais rappelé
          <% end %>
        <% end %>
        <% if (can? :care_confirm, WaitingList) && waiting_list.waiting_for_patient_return %>
          <%= link_to care_confirm_waiting_list_path(waiting_list), class: "btn btn-info btn-sm btn-block" do %>
            <i class="glyphicon glyphicon-ok"></i> Prise en charge confirmée
          <% end %>
        <% end %>
        <% if (can? :availability_not_compatible, WaitingList) && waiting_list.waiting_for_patient_return %>
          <%= link_to availability_not_compatible_waiting_list_path(waiting_list), class: "btn btn-info btn-sm btn-block" do %>
            <i class="glyphicon glyphicon-time"></i> Horaires non compatibles
          <% end %>
        <% end %>
        <% if (can? :stop_registration, WaitingList) && !waiting_list.end_date.present? && !waiting_list.waiting_for_patient_return%>
          <%= link_to stop_registration_waiting_list_path(waiting_list), class: "btn btn-info btn-sm btn-block" do %>
            <i class="glyphicon glyphicon-remove"></i> Supprimer de la liste
          <% end %>
        <% end %>
        <% if can? :show, waiting_list %>
          <%= link_to '<span class="glyphicon glyphicon-eye-open"></span>'.html_safe, waiting_list %>
        <% end %>
        <% if can? :manage, waiting_list %>
          <%= link_to '<span class="glyphicon glyphicon-pencil"></span>'.html_safe, edit_waiting_list_path(waiting_list) %>
        <% end %>
      </div>
    </div>
    <% if waiting_list.comments %>
      <div class="row">
        <div class="col-xs-12 text-center">
          <strong>Commentaire(s) :</strong> <%= waiting_list.comments %>
        </div>
      </div>
    <% end %>
  <% end %>
<% else %>
  <div class="row text-center">
    <h3>Liste vide</h3>
  </div>
<% end %>