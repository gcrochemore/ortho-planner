<%
practitionners = Array.new
Practitioner.all.each do |practitionner|
	practitionners[practitionner.id] = practitionner.to_s
end

acts = Array.new
Act.all.each do |act|
	acts[act.id] = act.name
end

pathologies = Array.new
Pathology.all.each do |pathology|
	pathologies[pathology.id] = pathology.name
end

interaction_types = Array.new
InteractionType.all.each do |interaction_type|
	interaction_types[interaction_type.id] = interaction_type.name
end

interaction_objects = Array.new
InteractionObject.all.each do |interaction_object|
	interaction_objects[interaction_object.id] = interaction_object.name
end

  @waiting_lists.each do |waiting_list|
    %>

<%= waiting_list.id %>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;patient_id: <%= waiting_list.patient.id %><br>
&nbsp;&nbsp;&nbsp;&nbsp;firstname: <%= waiting_list.patient.first_name %><br>
&nbsp;&nbsp;&nbsp;&nbsp;lastname: <%= waiting_list.patient.last_name %><br>
&nbsp;&nbsp;&nbsp;&nbsp;email: <%= waiting_list.patient.first_name %>.<%= waiting_list.patient.last_name %>@ortho-planner.com<br>
&nbsp;&nbsp;&nbsp;&nbsp;password: ortho-planner<br>
&nbsp;&nbsp;&nbsp;&nbsp;birth_date: '<%= waiting_list.patient.birth_date %>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;birth_place: '<%= waiting_list.patient.birth_place %>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;roles: ['ROLE_USER']<br>
&nbsp;&nbsp;&nbsp;&nbsp;civility: <%= waiting_list.patient.is_male ? 'MR' : 'MME' %><br>
&nbsp;&nbsp;&nbsp;&nbsp;health_place: Cabinet d'orthophonie de Tôtes<br>
&nbsp;&nbsp;&nbsp;&nbsp;comments: "<%= waiting_list.patient.comments.gsub '"', '\"' %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;priority: <%= waiting_list.patient.priority %><br>
&nbsp;&nbsp;&nbsp;&nbsp;pathologies: [
	<% waiting_list.patient.pathologies.each do |pathology| %>
		"<%= pathologies[pathology.id] %>",
	<% end %>
]<br>
&nbsp;&nbsp;&nbsp;&nbsp;contacts: [
	<% waiting_list.patient.contact_informations.each do |contact| %>
		"<%= contact.value %>",
	<% end %>
&nbsp;&nbsp;&nbsp;&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;waiting_lists:<br>
	<% waiting_list.patient.waiting_lists.each do |waiting_list| %>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= waiting_list.id %>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_date: "<%= waiting_list.start_date %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_date: "<%= waiting_list.end_date %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathology: "<%= waiting_list.pathology_id ? pathologies[waiting_list.pathology_id] : '' %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comments: "<%= waiting_list.comments %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waiting_for_patient_return: "<%= waiting_list.waiting_for_patient_return %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registrer_by: "<%= waiting_list.versions.first.whodunnit.nil? ? "Inconnu" : practitionners[User.find(waiting_list.versions.first.whodunnit).andand.practitioner_id] %>"<br>
	<% end %>
&nbsp;&nbsp;&nbsp;&nbsp;interactions: <br>
	<% waiting_list.patient.interactions.each do |interaction| %>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= interaction.id %>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date: "<%= interaction.interaction_date %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with: "<%= practitionners[interaction.practitioner_id] %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object: "<%= interaction.interaction_object_id ? interaction_objects[interaction.interaction_object_id] : '' %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: "<%= interaction.interaction_type_id ? interaction_types[interaction.interaction_type_id] : '' %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comments: "<%= interaction.comments %>"<br>
	<% end %>
&nbsp;&nbsp;&nbsp;&nbsp;therapies: <br>
	<% waiting_list.patient.therapies.each do |therapy| %>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= therapy.id %>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with: "<%= therapy.practitioner_id ? practitionners[therapy.practitioner_id] : '' %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin_date: "<%= therapy.begin_date %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_date: "<%= therapy.end_date %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;health_place: Cabinet d'orthophonie de Tôtes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number_of_sessions: "<%= therapy.number_of_sessions %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session_duration: "<%= therapy.session_duration %>"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;act: "<%= therapy.act_id ? acts[therapy.act_id] : '' %>"<br>
	<% end %>
<br>
<br>

	<%
  end
%>